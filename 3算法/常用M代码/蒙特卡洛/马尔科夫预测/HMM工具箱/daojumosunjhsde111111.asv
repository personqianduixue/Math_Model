clear all
% y=[    1.0000    0.2953    0.0151    0.0032    0.9939    0.3012    0.0146       0    0.9571    0.2879    0.0131    0.0037    0.9601    0.2883    0.0125    0.0027;
%     1.0000    0.3009    0.0127    0.0015    0.9854    0.3027    0.0127         0    0.9397    0.2891    0.0121    0.0052    0.9881    0.2946    0.0126    0.0025;
%     1.0000    0.2991    0.0114    0.0008    0.9626    0.2981    0.0128         0    0.9132    0.2892    0.0121    0.0041    0.9856    0.2954    0.0109    0.0026;
% %1
%   1.0000    0.2876    0.0082    0.0007    0.9819    0.2680    0.0108         0    0.9149    0.2633    0.0135    0.0021    0.9000    0.2769    0.0124    0.0021;
%     0.9970    0.2929    0.0111    0.0010    0.9994    0.2870    0.0107  0.0007    1.0000    0.2897    0.0111    0.0003    0.9649    0.2987    0.0114         0;
%     0.9547    0.2868    0.0110    0.0030    0.9925    0.2901    0.0107    0.0011    1.0000    0.2897    0.0107    0.0002    0.9449    0.2949   0.0122         0;
% %无501
%   1.0000    0.2514    0.0103         0    0.8309    0.2389    0.0124    0.0021    0.8222    0.2486    0.0119    0.0003    0.7686    0.2359    0.0117    0.0030;
%     1.0000    0.2866    0.0114    0.0013    0.9774    0.2845    0.0118    0.0012    0.9540    0.2929    0.0119         0    0.8948    0.2769    0.0121    0.0050;
%     0.9970    0.2924    0.0110    0.0014    1.0000    0.2894    0.0110   0.0007    0.9509    0.2954    0.0124         0    0.8920    0.2837    0.0122    0.0041;
% %2000
% 0.8799    0.2817    0.0154    0.0053    0.9344    0.2838    0.0140    0.0045    0.9637    0.3061    0.0133         0    1.0000    0.3300    0.0123    0.0011;
%     0.8894    0.2748    0.0132    0.0066    0.9432    0.2893    0.0129    0.0041    1.0000    0.2994    0.0117         0    0.9563    0.2942    0.0130    0.0011;
%     0.8600    0.2743    0.0124    0.0042    0.9344    0.2877    0.0103    0.0028    1.0000    0.2917    0.0105         0    0.9582    0.2817    0.0108    0.0009;
% %800
% 1.0000    0.2737    0.0128    0.0049    0.8864    0.2865    0.0169        0    0.9328    0.2838    0.0125    0.0035    0.9274    0.2750    0.0136    0.0046;
%     0.9982    0.2949    0.0138    0.0038    1.0000    0.3029    0.0144         0    0.9496    0.2978    0.0122    0.0051    0.9658    0.3320    0.0143    0.0063;
%     1.0000    0.2869    0.0117    0.0022    0.9432    0.2910    0.0132         0    0.9090    0.2859    0.0122    0.0037    0.9325    0.2911    0.0120    0.0041;
% 
% %%%%%%%%%%%%%%%%%%%%%%%%%%%无故障97
% %800
% 0.8150    0.1638    0.0145    0.0032    1.0000    0.1749    0.0071         0    0.7937    0.1793    0.0125    0.0022    0.8641    0.1707   0.0114    0.0056;
%     0.9492    0.1721    0.0131    0.0028    1.0000    0.1780    0.0111         0    0.8318    0.1829    0.0131    0.0038    0.9157    0.1810    0.0122    0.0043;
%     0.9702    0.1813    0.0114         0    1.0000    0.1826    0.0091    0.0001    0.8809    0.1919    0.0105    0.0012    0.9713    0.1873    0.0104    0.0009;
% %500
% 0.8402    0.1818    0.0166    0.0051    0.9942    0.1869    0.0119        0    1.0000    0.1935    0.0116    0.0005    0.9196    0.1830    0.0119    0.0060;
%     0.8523    0.1752    0.0140    0.0044    1.0000    0.1724    0.0105         0    0.8970    0.1794    0.0123    0.0002    0.8563    0.1744    0.0121    0.0049;
% %     0.9486    0.1900    0.0126    0.0031    1.0000    0.1841    0.0112         0    0.9454    0.1880    0.0116    0.0009    0.9298    0.1893    0.0115    0.0033;
% % %1000
% % 0.9642    0.1788    0.0114    0.0006    0.9477    0.1843    0.0104         0    0.8670    0.1787    0.0108    0.0048    1.0000    0.1842    0.0109    0.0019;
% %     1.0000    0.1750    0.0109    0.0011    0.9071    0.1812    0.0123         0    0.8564    0.1799    0.0123    0.0047    0.9794    0.1821    0.0104    0.0031;
% %     0.9641    0.1824    0.0111         0    0.9362    0.1851    0.0110    0.0004    0.9170    0.1895    0.0109    0.0026    1.0000    0.1922    0.0099    0.0012;
% % 
% % %1
% % 1.0000    0.1797    0.0138         0    0.8014    0.1734    0.0170    0.0073    0.9335    0.1767    0.0130    0.0024    0.8645    0.1887    0.0144    0.0034;
% %     0.9593    0.1699    0.0114    0.0028    0.8690    0.1727    0.0135    0.0045    1.0000    0.1710    0.0103         0    0.8558    0.1783    0.0127    0.0006;
% %     0.9807    0.1858    0.0117    0.0017    0.9608    0.1875    0.0122    0.0033    1.0000    0.1831    0.0109         0    0.9104    0.1855    0.0118    0.0011;
% % 
% % %%%%%%%%%%%%%%%%%%%%%%%%%%%无故障98
% % %1
% % 0.8678    0.2393    0.0129    0.0049    0.8546    0.2291    0.0143         0    1.0000    0.2244    0.0098    0.0002    0.8507    0.2438    0.0147    0.0014;
% %     0.8599    0.2372    0.0144    0.0040    0.9231    0.2373    0.0113    0.0004    1.0000    0.2357    0.0121         0    0.9373    0.2445   0.0141    0.0016;
% %     0.8658    0.2419    0.0142    0.0048    0.9259    0.2378    0.0128    0.0015    1.0000    0.2404    0.0131         0    0.8730    0.2429    0.0140    0.0042;
% %800
% % 0.8386    0.2566    0.0108    0.0026    1.0000    0.2496    0.0126         0    0.8591    0.2502    0.0161    0.0016    0.7989    0.2506    0.0124    0.0038;
% %     0.9782    0.2588    0.0103    0.0003    1.0000    0.2587    0.0137         0    0.8863    0.2562    0.0141    0.0021    0.9328    0.2553    0.0113    0.0012;
% %     1.0000    0.2693    0.0125         0    0.9990    0.2660    0.0140    0.0021    0.9411    0.2608    0.0140    0.0022    0.9491    0.2657    0.0131    0.0022;
% % %无501
% % 0.8674    0.2354    0.0153         0    1.0000    0.2232    0.0098   0.0003    0.8728    0.2372    0.0143    0.0014    0.7866    0.2219  0.0152    0.0039;
% % 0.9097    0.2406    0.0120    0.0000    1.0000    0.2342    0.0119   0    0.9243    0.2393    0.0137    0.0014    0.8304    0.2333  0.0140    0.0030;
% % 0.9178    0.2399    0.0130    0.0013    1.0000    0.2390    0.0130 0    0.8821    0.2388    0.0135    0.0041    0.8848    0.2329  0.0145    0.0032;
% % %无1001
% % 1.0000    0.2391    0.0092         0    0.8974    0.2482    0.0139  0.0003    0.8278    0.2268    0.0157    0.0023    0.9483    0.2339 0.0083    0.0019;
% % 1.0000    0.2396    0.0115         0    0.9360    0.2458    0.0135   0.0009    0.8613    0.2375    0.0138    0.0025    0.9411    0.2374  0.0108    0.0007;
% % 1.0000    0.2446    0.0124         0    0.8933    0.2451    0.0134   0.0038    0.9257    0.2365    0.0144    0.0030    0.9096    0.2426  0.0131    0.0013;
% 
% %%%%%%%%%%%%%%%%%%%%%%%%%%WAIQUAN 
% %%%%%%%%%%%%%%%外圈145
% %2001
% 0.1010    0.8809    0.1875    0.0054    0.1092    0.8737    0.1934   0    0.0986    0.9169    0.1742    0.0043    0.1028    1.0000  0.2087    0.0017;
%     0.1028    0.9472    0.1901    0.0054    0.1112    0.9165    0.1995  0    0.1085    0.9617    0.1784    0.0038    0.1123    1.0000  0.2147    0.0008;
%     0.1053    1.0000    0.1956    0.0061    0.1134    0.9577    0.2071    0    0.1119    0.9963    0.1848    0.0041    0.1187    0.9879     0.2166    0.0009;
% %1
% % 0.1010    0.8809    0.1875    0.0054    0.1092    0.8737    0.1934  0    0.0986    0.9169    0.1742    0.0043    0.1028    1.0000  0.2087    0.0017;
% %     0.1028    0.9472    0.1901    0.0054    0.1112    0.9165    0.1995    0    0.1085    0.9617    0.1784    0.0038    0.1123    1.0000  0.2147    0.0008;
% %     0.1053    1.0000    0.1956    0.0061    0.1134    0.9577    0.2071    0    0.1119    0.9963    0.1848    0.0041    0.1187    0.9879     0.2166    0.0009;  
%     
% %500 
% 0.1210    1.0000    0.2197         0    0.1123    0.9968    0.2017   0.0034    0.1171    0.9689    0.2189    0.0014    0.1184    0.9531    0.1950    0.0065;
%     0.1224    0.9825    0.2194         0    0.1097    1.0000    0.1962  0.0047    0.1153    0.9765    0.2237    0.0017    0.1148    0.9959   0.2060    0.0061;
%     0.1187    0.9857    0.2106         0    0.1091    0.9797    0.1877   0.0042    0.1142    0.9513    0.2147    0.0009    0.1077    1.0000   0.1985    0.0054 ;
%  %800
%  0.1244    1.0000    0.2158         0    0.0952    0.8851    0.2363    0.0071    0.1253    0.9819    0.2229    0.0010    0.1025    0.9104    0.2338    0.0078;
%     0.1226    0.9978    0.2117         0    0.0920    0.8896    0.2361    0.0074    0.1222    1.0000    0.2196    0.0007    0.0952    0.9033    0.2325    0.0080;
%     0.1246    1.0000    0.2027         0    0.0926    0.8739    0.2286    0.0075    0.1186    0.9853    0.2120    0.0012    0.0915    0.8945    0.2269    0.0080;
% %1000
% 0.1130    1.0000    0.2122    0.0066    0.1156    0.9439    0.2473    0.0032    0.1093    0.9889    0.2217    0.0099    0.1278    0.9680    0.2451         0;
%     0.1093    0.9985    0.2047    0.0076    0.1144    0.9630    0.2494    0.0028    0.1062    1.0000    0.2184    0.0099    0.1243    0.9683    0.2424         0;
%     0.1101    1.0000    0.2029    0.0075    0.1159    0.9630    0.2440    0.0024    0.1028    0.9952    0.2166    0.0098    0.1192    0.9842   0.2386         0;
% 
% %%%%%%%%%%%%%%%外圈146 
% %500
% 0.1166    1.0000    0.2359         0    0.1081    0.9618    0.2232   0.0042    0.1121    0.9332    0.2409    0.0015    0.1122    0.9209  0.2114    0.0087;
%     0.1227    1.0000    0.2424         0    0.1072    0.9846    0.2214    0.0060    0.1127    0.9503    0.2516    0.0020    0.1118    0.9827   0.2284    0.0085;
%     0.1162    1.0000    0.2375         0    0.1074    0.9676    0.2128    0.0059    0.1131    0.9354    0.2432    0.0016    0.1054    0.9859     0.2236    0.0079 ;
%  %1   
%  0.1056    0.9808    0.2272    0.0081    0.1151    1.0000    0.2328  0    0.1077    0.9452    0.2215    0.0045    0.1220    0.9592    0.2391    0.0005;
%     0.1078    0.9841    0.2279    0.0095    0.1208    1.0000    0.2354    0    0.1062    0.9670    0.2194    0.0065    0.1206    0.9978   0.2478    0.0013;
%     0.1084    0.9760    0.2269    0.0094    0.1200    0.9952    0.2341    0    0.1089    0.9729    0.2163    0.0068    0.1221    1.0000   0.2445    0.0015;
%  
%  %1001
%   0.1130    1.0000    0.2122    0.0066    0.1156    0.9439    0.2473  0.0032    0.1093    0.9889    0.2217    0.0099    0.1278    0.9680  0.2451         0;
%     0.1093    0.9985    0.2047    0.0076    0.1144    0.9630    0.2494   0.0028    0.1062    1.0000    0.2184    0.0099    0.1243    0.9683  0.2424         0;
% %     0.1101    1.0000    0.2029    0.0075    0.1159    0.9630    0.2440  0.0024    0.1028    0.9952    0.2166    0.0098    0.1192    0.9842  0.2386         0 ;
% %     
% % %2001
% % 0.0977    0.8699    0.2115    0.0076    0.1098    0.8924    0.2193  0    0.0973    0.9170    0.1949    0.0054    0.1025    1.0000  0.2314    0.0022;
% %     0.0967    0.9041    0.2048    0.0075    0.1070    0.8998    0.2185    0    0.1035    0.9206    0.1919    0.0050    0.1081    1.0000    0.2294    0.0015;
% %     0.1025    0.9874    0.2184    0.0085    0.1135    0.9785    0.2349   0    0.1104    0.9873    0.2062    0.0054    0.1184    1.0000  0.2406    0.0015;
% %   %800
% %    0.1401    1.0000    0.2312         0    0.0999    0.9353    0.2255    0.0109    0.1372    0.9847    0.2229    0.0009    0.0925    0.9485    0.2596    0.0125;
% %     0.1343    1.0000    0.2370         0    0.0990    0.9527    0.2286    0.0118    0.1287    0.9951    0.2255    0.0011    0.0921    0.9627    0.2594    0.0126;
% %     0.1303    1.0000    0.2342         0    0.0943    0.9511    0.2288    0.0117    0.1268    0.9956    0.2262    0.0006    0.0912    0.9474    0.2419    0.0123;
% %%%%%%%%%%%%%%%%%%%%%225滚动
% 0.5320    0.3942    1.0000         0    0.5183    0.4148    0.8978  0.0016    0.4626    0.4248    0.8969    0.0086    0.4509    0.5094  0.8087    0.0086;
%     0.5122    0.3546    1.0000         0    0.4651    0.3839    0.9236  0.0108    0.4210    0.4241    0.9481    0.0083    0.4526    0.4960  0.8839    0.0009;
%     0.4949    0.4222    1.0000         0    0.4292    0.3645    0.8898   0.0386    0.4150    0.4734    0.9172    0.0134    0.4573    0.4884   0.8876    0.0112;
% %1001
%  0.4855    0.5098    0.8917         0    0.4638    0.4288    0.9247   0.0172    0.5319    0.3963    1.0000    0.0015    0.5319    0.4330  0.9440    0.0042;
%     0.4638    0.4661    0.8761         0    0.4464    0.4552    0.8791  0.0101    0.5059    0.3624    1.0000    0.0017    0.4725    0.3955   0.9243    0.0130;
%     0.4436    0.4669    0.9206    0.0058    0.4539    0.4688    0.9233   0.0076    0.4884    0.4124    1.0000         0    0.4349    0.3819  0.8937    0.0360;
% %500
% 0.5146    0.4218    0.9885    0.0016    0.4811    0.4950    0.9732       0    0.4747    0.4353    0.9495    0.0174    0.5530    0.4039  1.0000    0.0015;
%     0.5167    0.4150    0.9389         0    0.4695    0.4646    0.9336    0.0017    0.4554    0.4599    0.9032    0.0125    0.5192    0.3679   1.0000    0.0049;
%     0.4898    0.4169    0.9904    0.0069    0.4557    0.4684    0.9834    0.0032    0.4668    0.4796    0.9474    0.0058    0.5013    0.4216  1.0000         0;
% %800
% 0.4736    0.4633    0.8936         0    0.4444    0.4293    0.8975    0.0152    0.4824    0.3865    1.0000    0.0068    0.5131    0.3813    0.8164    0.0066;
%     0.4823    0.4486    0.8999         0    0.4422    0.4658    0.8538    0.0084    0.4718    0.3767    1.0000    0.0067    0.4860    0.3613    0.8707    0.0117;
%     0.4462    0.4324    0.9229    0.0050    0.4437    0.4741    0.9134    0.0012    0.4561    0.4076    1.0000         0    0.4365    0.3681    0.8457    0.0267;
% %1
% 0.4869    0.3747    1.0000         0    0.4763    0.3780    0.8773    0.0010    0.4388    0.4513    0.9057    0.0002    0.4484    0.3985    0.8086    0.0140;
%     0.5086    0.3918    1.0000         0    0.5002    0.3982    0.9035    0.0015    0.4510    0.4488    0.9097    0.0043    0.4459    0.4410    0.8598    0.0138;
%     0.5172    0.3780    1.0000         0    0.4771    0.3943    0.9354    0.0104    0.4387    0.4541    0.9576    0.0062    0.4542    0.4735   0.8971    0.0085;
%  %%%%%%%%%%%%%%%%%%%%%225滚动
%  %1
%   0.9316    0.6241    0.9411    0.0207    0.8371    0.6382    1.0000    0.0335    0.9263    0.6964    0.9608         0    0.9532    0.6429    0.9495    0.0116;
%     0.8285    0.6432    0.8831    0.0146    0.8422    0.6265    0.9444    0.0169    0.8113    0.7057    0.8468    0.0027    0.8620    0.6593    1.0000         0;
%     0.8799    0.6695    0.8900    0.0030    0.8878    0.6394    0.9732    0.0065    0.8795    0.6820    0.8642         0    0.8579    0.6782   1.0000    0.0015;
% %500
% 0.8838    0.6932    0.9715    0.0370    0.9549    0.7269    1.0000         0    0.9739    0.6705    0.9863    0.0152    0.8253    0.7401    0.9104    0.0347;
%     0.8819    0.6447    0.8805    0.0161    0.8108    0.7078    0.8545    0.0035    0.8565    0.6680    1.0000         0    0.8215    0.6573    0.8267    0.0156;
% %     0.9175    0.6558    0.9363    0.0083    0.8840    0.6861    0.8685         0    0.8488    0.6859    1.0000    0.0031    0.8549    0.6656    0.9171    0.0082;
% %  %800
% %  0.8654    0.7076    0.8843    0.0043    0.9280    0.6275    1.0000    0.0011    0.8961    0.6818    0.8148         0    0.9436    0.6349    0.9652    0.0019;
% %     0.7943    0.7377    0.9344    0.0165    0.8500    0.6851    1.0000    0.0058    0.9094    0.6549    0.8666    0.0077    0.8901    0.6806    0.9193         0;
% %     0.8827    0.6982    0.9819    0.0100    0.8625    0.6930    1.0000    0.0066    0.9270    0.6576    0.9426         0    0.9188    0.6959    0.9493    0.0013;
% % %2000
% % 0.7712    0.6295    0.7880    0.0214    0.8544    0.6049    0.9009    0.0122    0.7276    0.7111    0.7595    0.0156    0.7843    0.7118    1.0000         0;
% %     0.8832    0.6550    0.8697    0.0093    0.9083    0.6464    0.9709         0    0.8716    0.6800    0.8261    0.0072    0.8174    0.7143    1.0000    0.0076;
% %     0.9032    0.6608    0.9340    0.0092    0.8994    0.6933    0.9876    0.0042    0.9316    0.6769    0.8619    0.0042    0.9085    0.7010    1.0000         0;
% % 
% % %1000
% % 0.9451    0.7098    0.8803         0    0.9167    0.6349    0.9583    0.0101    0.8505    0.6896    0.8848    0.0161    0.9079    0.6590    1.0000    0.0240;
% %     0.8416    0.7285    0.7985    0.0038    0.8416    0.6590    1.0000         0    0.8534    0.6488    0.8154    0.0099    0.8499    0.6134    0.9065    0.0152;
% %     0.9019    0.7022    0.8330         0    0.8384    0.6788    1.0000    0.0039    0.8845    0.6539    0.9001    0.0044    0.8510    0.6660    0.9442    0.0080;
% %  %%%%%%%%%%%%%%%%%%%%%224滚动
% % %1000
% % 0.6330    0.5204    0.7480    0.0299    0.6022    0.5017    1.0000    0.0145    0.6029    0.5197    0.9245         0    0.6003    0.5043    0.9360    0.0273;
% %     0.6525    0.5210    0.8441    0.0157    0.6476    0.4924    1.0000    0.0105    0.6741    0.5078    0.9456         0    0.6463    0.5264    0.9225    0.0253;
% %     0.6484    0.5172    0.8755    0.0082    0.6439    0.5204    0.9827    0.0023    0.6455    0.5071    1.0000         0    0.6371    0.5163    0.9849    0.0114;    
% % %2000
% %    0.6216    0.5350    0.9012    0.0004    0.6110    0.4990    1.0000         0    0.6850    0.5198    0.9526    0.0021    0.7221    0.4953    0.9170    0.0005;
% %     0.7051    0.5305    0.9515         0    0.6609    0.5277    1.0000    0.0099    0.6778    0.5448    0.9764    0.0081    0.6949    0.5590    0.9373    0.0084;
% %     0.6526    0.5112    0.9795         0    0.6414    0.5144    1.0000    0.0008    0.6553    0.5204    0.9383    0.0007    0.6797    0.5073    0.9524    0.0019;
% % %500
% % 0.6542    0.4211    0.9369    0.0228    0.5899    0.4818    0.7829    0.0307    0.6033    0.5012    1.0000    0.0164    0.6212    0.5577    0.9700         0;
% %     0.6359    0.4457    0.9671    0.0126    0.6332    0.4982    0.8783    0.0173    0.6486    0.4867    1.0000    0.0098    0.6889    0.5224    0.9640         0;
% %     0.6541    0.4891    0.9597    0.0032    0.6450    0.5158    0.9254    0.0057    0.6549    0.5214    1.0000         0    0.6638    0.5255    0.9911    0.0022;
% %   %1
% %     0.6798    0.5305    0.6628    0.0220    0.6173    0.4207    0.8904         0    0.5721    0.4651    0.7560    0.0154    0.5766    0.4773    1.0000    0.0065;
% %     0.6497    0.5457    0.7311    0.0079    0.6081    0.4420    0.9083         0    0.6099    0.4776    0.8394    0.0077    0.6152    0.4674    1.0000    0.0049;
% %     0.6735    0.5237    0.7873         0    0.6223    0.4656    0.9103    0.0032    0.6148    0.4922    0.8721    0.0064    0.6179    0.4940    1.0000    0.0050;
% %   
%     %%%%%%%%%%%%%%%%%%%%%%%%%内圈210
% %1
% 0.3168    0.9845    0.5519         0    0.3045    1.0000    0.5460    0.0001    0.2827    0.8788    0.5613    0.0042    0.3380    0.9422    0.4611    0.0089;
%     0.3230    1.0000    0.5671         0    0.3014    0.9660    0.5248    0.0037    0.2831    0.8734    0.5546    0.0045    0.3540    0.8980    0.4514    0.0073;
%     0.3197    1.0000    0.5773         0    0.3037    0.9955    0.5613    0.0034    0.2937    0.8939    0.5748    0.0049    0.3488    0.9400    0.4822    0.0079;
% %500
%   0.2980    1.0000    0.5246    0.0010    0.2557    0.8596    0.6083    0.0048    0.2889    0.9318    0.5235    0.0047    0.3039    0.9848    0.5258         0;
%     0.2918    1.0000    0.5121    0.0023    0.2640    0.8671    0.5922    0.0033    0.3068    0.8949    0.5120    0.0047    0.3033    0.9561    0.5345         0;
%     0.2895    1.0000    0.5311    0.0010    0.2721    0.8744    0.5988    0.0017    0.2959    0.9188    0.5324    0.0034    0.2970    0.9308    0.5284         0;   
% %1000
% 0.2828    0.8502    0.5570    0.0079    0.2952    0.9614    0.5385    0.0061    0.2868    1.0000    0.6096         0    0.3056    0.9230    0.5620    0.0025;
%     0.2917    0.9098    0.5829    0.0044    0.3259    0.9368    0.5319    0.0053    0.3054    1.0000    0.5948         0    0.3107    0.9692    0.6115    0.0025;
%     0.2981    0.9401    0.6124    0.0020    0.3182    0.9709    0.5604    0.0033    0.3002    1.0000    0.5921         0    0.3157    0.9943    0.6004    0.0009;
% %2000
%     0.3612    0.9747    0.6122         0    0.3043    1.0000    0.5696    0.0065    0.2904    0.9273    0.6290    0.0045    0.3651    0.9531    0.4956    0.0083;
%     0.3466    0.9530    0.5874         0    0.2976    1.0000    0.5749    0.0056    0.2957    0.9077    0.6352    0.0043    0.3351    0.9733    0.5219    0.0081;
%     0.3225    0.9337    0.5637         0    0.2884    1.0000    0.5810    0.0027    0.2850    0.9114    0.6213    0.0021    0.3230    0.9500    0.5322    0.0046;
% 
%     %%%%%%%%%%%%%%%%%%%%%%%%%内圈210
% %1
% 0.3904    0.8831    0.7692         0    0.3094    1.0000    0.6301    0.0076    0.2757    0.9399    0.7914    0.0068    0.3128    0.9404    0.5423    0.0141;
%  0.3388    0.8698    0.7135    0.0063    0.3129    1.0000    0.6280    0.0003    0.2827    0.9442    0.7784         0    0.3097    0.9342    0.5609    0.0071;
%  0.3148    0.8740    0.6922    0.0085    0.3039    1.0000    0.6134    0.0023    0.2814    0.9396    0.7393         0    0.2928    0.9348    0.5758    0.0077;
% %2000
%  0.3230    0.8975    0.6602    0.0103    0.3281    1.0000    0.6381         0    0.2942    0.9699    0.7800    0.0004    0.3064    0.9850    0.6006    0.0071;
%     0.3070    0.8714    0.6499    0.0124    0.3109    1.0000    0.6155    0.0026    0.2876    0.9622    0.7293         0    0.2831    0.9907    0.6094    0.0077;
%     0.3028    0.8856    0.6672    0.0096    0.3022    1.0000    0.6302    0.0026    0.2842    0.9744    0.7304         0    0.2802    0.9940    0.6056    0.0083;
% %1000
%  0.2799    0.9509    0.7659    0.0006    0.2976    0.9678    0.5610    0.0074    0.2978    0.8908    0.6250    0.0070    0.3330    1.0000    0.6170         0;
%     0.2866    0.9391    0.7548         0    0.2914    0.9495    0.5738    0.0075    0.2851    0.8889    0.6348    0.0058    0.3135    1.0000    0.6049    0.0012;
% %     0.2893    0.9615    0.7282         0    0.2817    0.9643    0.6058    0.0086    0.2873    0.9130    0.6552    0.0049    0.3015    1.0000    0.6252    0.0026;
% % %500
% %  0.2846    1.0000    0.6214         0    0.2587    0.9050    0.7433    0.0002    0.2813    0.9016    0.5473    0.0078    0.2943    0.8503    0.5988    0.0055;
% %     0.2971    1.0000    0.5985         0    0.2685    0.9002    0.7235    0.0005    0.2771    0.8977    0.5650    0.0086    0.2779    0.8637    0.6120    0.0064;
% %     0.2849    1.0000    0.5678    0.0013    0.2633    0.8849    0.6764         0    0.2604    0.8853    0.5723    0.0085    0.2711    0.8578    0.6034    0.0044;
% % 
% % %%%%%%%%%%%%%%%%%%%%%%%%%%%内圈108
% % %1
% %    0.6096    0.8142    1.0000         0    0.5869    0.7663    0.8872    0.0105    0.5683    0.7975    0.9547    0.0030    0.6128    0.7706    0.8586    0.0143;
% %     0.6196    0.8224    1.0000         0    0.5883    0.7783    0.8835    0.0082    0.5787    0.8001    0.9581    0.0001    0.6273    0.7944    0.8910    0.0067;
% %     0.5871    0.7721    1.0000         0    0.5714    0.7755    0.8771    0.0081    0.5738    0.7863    0.9304    0.0008    0.6125    0.7859    0.8761    0.0061;
% % %500
% % 0.5547    0.7843    0.8536    0.0122    0.5444    0.7550    0.9557    0.0031    0.5726    0.7318    0.8320    0.0123    0.5735    0.7699  1.0000         0;
% %     0.5716    0.7668    0.8643    0.0084    0.5631    0.7728    0.9521    0.0007    0.5902    0.7539    0.8645    0.0073    0.5792    0.7535   1.0000         0;
% %     0.5641    0.7700    0.8660    0.0083    0.5689    0.7748    0.9325    0.0006    0.5837    0.7630    0.8781    0.0059    0.5717    0.7556  1.0000         0;
% % %1000
% % 0.5522    0.7479    0.8921    0.0074    0.5537    0.7047    0.7961    0.0146    0.5437    0.7326    1.0000         0    0.5418    0.7203    0.8387    0.0079;
% %     0.5819    0.7703    0.8983    0.0049    0.5899    0.7517    0.8600    0.0085    0.5745    0.7539    1.0000         0    0.5640    0.7687    0.8699    0.0059;
% %     0.5792    0.7895    0.9306    0.0027    0.5939    0.7740    0.8957    0.0056    0.5783    0.7718    1.0000         0    0.5839    0.7759    0.8658    0.0053;
% % %2000
% % 0.4913    0.6550    1.0000    0.0043    0.5016    0.6786    0.7482    0.0075    0.5061    0.6906    0.8133         0    0.5652    0.6757    0.7148    0.0059;
% %     0.5224    0.6961    1.0000    0.0023    0.5182    0.7250    0.8182    0.0059    0.5363    0.7200    0.8531         0    0.5726    0.7207    0.7914    0.0052;
% %     0.5583    0.7463    1.0000    0.0004    0.5582    0.7603    0.8525    0.0045    0.5592    0.7624    0.8938         0    0.5860    0.7703    0.8428    0.0032;
% ];
y=  [1.0000    0.2953    0.0151    0.0032    0.9939    0.3012    0.0146       0    0.9571    0.2879    0.0131    0.0037    0.9601    0.2883    0.0125    0.0027;
    1.0000    0.3009    0.0127    0.0015    0.9854    0.3027    0.0127         0    0.9397    0.2891    0.0121    0.0052    0.9881    0.2946    0.0126    0.0025;
    1.0000    0.2991    0.0114    0.0008    0.9626    0.2981    0.0128         0    0.9132    0.2892    0.0121    0.0041    0.9856    0.2954    0.0109    0.0026;
%1
  1.0000    0.2876    0.0082    0.0007    0.9819    0.2680    0.0108         0    0.9149    0.2633    0.0135    0.0021    0.9000    0.2769    0.0124    0.0021;
    0.9970    0.2929    0.0111    0.0010    0.9994    0.2870    0.0107  0.0007    1.0000    0.2897    0.0111    0.0003    0.9649    0.2987    0.0114         0;
    0.9547    0.2868    0.0110    0.0030    0.9925    0.2901    0.0107    0.0011    1.0000    0.2897    0.0107    0.0002    0.9449    0.2949   0.0122         0;
%无501
  1.0000    0.2514    0.0103         0    0.8309    0.2389    0.0124    0.0021    0.8222    0.2486    0.0119    0.0003    0.7686    0.2359    0.0117    0.0030;
    1.0000    0.2866    0.0114    0.0013    0.9774    0.2845    0.0118    0.0012    0.9540    0.2929    0.0119         0    0.8948    0.2769    0.0121    0.0050;
    0.9970    0.2924    0.0110    0.0014    1.0000    0.2894    0.0110   0.0007    0.9509    0.2954    0.0124         0    0.8920    0.2837    0.0122    0.0041;
%2000
0.8799    0.2817    0.0154    0.0053    0.9344    0.2838    0.0140    0.0045    0.9637    0.3061    0.0133         0    1.0000    0.3300    0.0123    0.0011;
    0.8894    0.2748    0.0132    0.0066    0.9432    0.2893    0.0129    0.0041    1.0000    0.2994    0.0117         0    0.9563    0.2942    0.0130    0.0011;
    0.8600    0.2743    0.0124    0.0042    0.9344    0.2877    0.0103    0.0028    1.0000    0.2917    0.0105         0    0.9582    0.2817    0.0108    0.0009;
%800
1.0000    0.2737    0.0128    0.0049    0.8864    0.2865    0.0169        0    0.9328    0.2838    0.0125    0.0035    0.9274    0.2750    0.0136    0.0046;
    0.9982    0.2949    0.0138    0.0038    1.0000    0.3029    0.0144         0    0.9496    0.2978    0.0122    0.0051    0.9658    0.3320    0.0143    0.0063;
    1.0000    0.2869    0.0117    0.0022    0.9432    0.2910    0.0132         0    0.9090    0.2859    0.0122    0.0037    0.9325    0.2911    0.0120    0.0041;

%%%%%%%%%%%%%%%%%%%%%%%%%%%无故障97
%800
0.8150    0.1638    0.0145    0.0032    1.0000    0.1749    0.0071         0    0.7937    0.1793    0.0125    0.0022    0.8641    0.1707   0.0114    0.0056;
    0.9492    0.1721    0.0131    0.0028    1.0000    0.1780    0.0111         0    0.8318    0.1829    0.0131    0.0038    0.9157    0.1810    0.0122    0.0043;
    0.9702    0.1813    0.0114         0    1.0000    0.1826    0.0091    0.0001    0.8809    0.1919    0.0105    0.0012    0.9713    0.1873    0.0104    0.0009;
%500
0.8402    0.1818    0.0166    0.0051    0.9942    0.1869    0.0119        0    1.0000    0.1935    0.0116    0.0005    0.9196    0.1830    0.0119    0.0060;
    0.8523    0.1752    0.0140    0.0044    1.0000    0.1724    0.0105         0    0.8970    0.1794    0.0123    0.0002    0.8563    0.1744    0.0121    0.0049;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    0.1010    0.8809    0.1875    0.0054    0.1092    0.8737    0.1934   0    0.0986    0.9169    0.1742    0.0043    0.1028    1.0000  0.2087    0.0017;
    0.1028    0.9472    0.1901    0.0054    0.1112    0.9165    0.1995  0    0.1085    0.9617    0.1784    0.0038    0.1123    1.0000  0.2147    0.0008;
    0.1053    1.0000    0.1956    0.0061    0.1134    0.9577    0.2071    0    0.1119    0.9963    0.1848    0.0041    0.1187    0.9879     0.2166    0.0009;
%500 
0.1210    1.0000    0.2197         0    0.1123    0.9968    0.2017   0.0034    0.1171    0.9689    0.2189    0.0014    0.1184    0.9531    0.1950    0.0065;
    0.1224    0.9825    0.2194         0    0.1097    1.0000    0.1962  0.0047    0.1153    0.9765    0.2237    0.0017    0.1148    0.9959   0.2060    0.0061;
    0.1187    0.9857    0.2106         0    0.1091    0.9797    0.1877   0.0042    0.1142    0.9513    0.2147    0.0009    0.1077    1.0000   0.1985    0.0054 ;
 %800
 0.1244    1.0000    0.2158         0    0.0952    0.8851    0.2363    0.0071    0.1253    0.9819    0.2229    0.0010    0.1025    0.9104    0.2338    0.0078;
    0.1226    0.9978    0.2117         0    0.0920    0.8896    0.2361    0.0074    0.1222    1.0000    0.2196    0.0007    0.0952    0.9033    0.2325    0.0080;
    0.1246    1.0000    0.2027         0    0.0926    0.8739    0.2286    0.0075    0.1186    0.9853    0.2120    0.0012    0.0915    0.8945    0.2269    0.0080;
%1000
0.1130    1.0000    0.2122    0.0066    0.1156    0.9439    0.2473    0.0032    0.1093    0.9889    0.2217    0.0099    0.1278    0.9680    0.2451         0;
    0.1093    0.9985    0.2047    0.0076    0.1144    0.9630    0.2494    0.0028    0.1062    1.0000    0.2184    0.0099    0.1243    0.9683    0.2424         0;
    0.1101    1.0000    0.2029    0.0075    0.1159    0.9630    0.2440    0.0024    0.1028    0.9952    0.2166    0.0098    0.1192    0.9842   0.2386         0;

%%%%%%%%%%%%%%%外圈146 
%500
0.1166    1.0000    0.2359         0    0.1081    0.9618    0.2232   0.0042    0.1121    0.9332    0.2409    0.0015    0.1122    0.9209  0.2114    0.0087;
    0.1227    1.0000    0.2424         0    0.1072    0.9846    0.2214    0.0060    0.1127    0.9503    0.2516    0.0020    0.1118    0.9827   0.2284    0.0085;
    0.1162    1.0000    0.2375         0    0.1074    0.9676    0.2128    0.0059    0.1131    0.9354    0.2432    0.0016    0.1054    0.9859     0.2236    0.0079 ;
 %1   
 0.1056    0.9808    0.2272    0.0081    0.1151    1.0000    0.2328  0    0.1077    0.9452    0.2215    0.0045    0.1220    0.9592    0.2391    0.0005;
    0.1078    0.9841    0.2279    0.0095    0.1208    1.0000    0.2354    0    0.1062    0.9670    0.2194    0.0065    0.1206    0.9978   0.2478    0.0013;
    0.1084    0.9760    0.2269    0.0094    0.1200    0.9952    0.2341    0    0.1089    0.9729    0.2163    0.0068    0.1221    1.0000   0.2445    0.0015;
 0.1172  0.9184  0.2046  0.0071  0.1114  0.9066  0.2332  0.0026  0.111  1  0.2185  0.0035  0.1096  0.9558  0.2505  0;
     0.1211  0.9934  0.218  0.0054  0.1118  0.9304  0.2415  0.003  0.1226  1  0.213  0.0029  0.1144  0.9545  0.253  0;
%     % 0.1179  1  0.2161  0.0041  0.1055  0.93  0.2419  0.0026  0.1242  0.9812  0.2083  0.0013  0.1119  0.9214  0.2468  0;     
%  %1001
%   0.1130    1.0000    0.2122    0.0066    0.1156    0.9439    0.2473  0.0032    0.1093    0.9889    0.2217    0.0099    0.1278    0.9680  0.2451         0;
%     0.1093    0.9985    0.2047    0.0076    0.1144    0.9630    0.2494   0.0028    0.1062    1.0000    0.2184    0.0099    0.1243    0.9683  0.2424         0;
%     0.1101    1.0000    0.2029    0.0075    0.1159    0.9630    0.2440  0.0024    0.1028    0.9952    0.2166    0.0098    0.1192    0.9842  0.2386         0 ;
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
0.5320    0.3942    1.0000         0    0.5183    0.4148    0.8978  0.0016    0.4626    0.4248    0.8969    0.0086    0.4509    0.5094  0.8087    0.0086;
    0.5122    0.3546    1.0000         0    0.4651    0.3839    0.9236  0.0108    0.4210    0.4241    0.9481    0.0083    0.4526    0.4960  0.8839    0.0009;
    0.4949    0.4222    1.0000         0    0.4292    0.3645    0.8898   0.0386    0.4150    0.4734    0.9172    0.0134    0.4573    0.4884   0.8876    0.0112;
%1001
 0.4855    0.5098    0.8917         0    0.4638    0.4288    0.9247   0.0172    0.5319    0.3963    1.0000    0.0015    0.5319    0.4330  0.9440    0.0042;
    0.4638    0.4661    0.8761         0    0.4464    0.4552    0.8791  0.0101    0.5059    0.3624    1.0000    0.0017    0.4725    0.3955   0.9243    0.0130;
    0.4436    0.4669    0.9206    0.0058    0.4539    0.4688    0.9233   0.0076    0.4884    0.4124    1.0000         0    0.4349    0.3819  0.8937    0.0360;
%500
0.5146    0.4218    0.9885    0.0016    0.4811    0.4950    0.9732       0    0.4747    0.4353    0.9495    0.0174    0.5530    0.4039  1.0000    0.0015;
    0.5167    0.4150    0.9389         0    0.4695    0.4646    0.9336    0.0017    0.4554    0.4599    0.9032    0.0125    0.5192    0.3679   1.0000    0.0049;
    0.4898    0.4169    0.9904    0.0069    0.4557    0.4684    0.9834    0.0032    0.4668    0.4796    0.9474    0.0058    0.5013    0.4216  1.0000         0;
%800
0.4736    0.4633    0.8936         0    0.4444    0.4293    0.8975    0.0152    0.4824    0.3865    1.0000    0.0068    0.5131    0.3813    0.8164    0.0066;
    0.4823    0.4486    0.8999         0    0.4422    0.4658    0.8538    0.0084    0.4718    0.3767    1.0000    0.0067    0.4860    0.3613    0.8707    0.0117;
    0.4462    0.4324    0.9229    0.0050    0.4437    0.4741    0.9134    0.0012    0.4561    0.4076    1.0000         0    0.4365    0.3681    0.8457    0.0267;
%1
0.4869    0.3747    1.0000         0    0.4763    0.3780    0.8773    0.0010    0.4388    0.4513    0.9057    0.0002    0.4484    0.3985    0.8086    0.0140;
    0.5086    0.3918    1.0000         0    0.5002    0.3982    0.9035    0.0015    0.4510    0.4488    0.9097    0.0043    0.4459    0.4410    0.8598    0.0138;
    0.5172    0.3780    1.0000         0    0.4771    0.3943    0.9354    0.0104    0.4387    0.4541    0.9576    0.0062    0.4542    0.4735   0.8971    0.0085;
 %%%%%%%%%%%%%%%%%%%%%225滚动
 %1
  0.9316    0.6241    0.9411    0.0207    0.8371    0.6382    1.0000    0.0335    0.9263    0.6964    0.9608         0    0.9532    0.6429    0.9495    0.0116;
    0.8285    0.6432    0.8831    0.0146    0.8422    0.6265    0.9444    0.0169    0.8113    0.7057    0.8468    0.0027    0.8620    0.6593    1.0000         0;
    0.8799    0.6695    0.8900    0.0030    0.8878    0.6394    0.9732    0.0065    0.8795    0.6820    0.8642         0    0.8579    0.6782   1.0000    0.0015;
%500
0.8838    0.6932    0.9715    0.0370    0.9549    0.7269    1.0000         0    0.9739    0.6705    0.9863    0.0152    0.8253    0.7401    0.9104    0.0347;
    0.8819    0.6447    0.8805    0.0161    0.8108    0.7078    0.8545    0.0035    0.8565    0.6680    1.0000         0    0.8215    0.6573    0.8267    0.0156;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    
    0.3168    0.9845    0.5519         0    0.3045    1.0000    0.5460    0.0001    0.2827    0.8788    0.5613    0.0042    0.3380    0.9422    0.4611    0.0089;
    0.3230    1.0000    0.5671         0    0.3014    0.9660    0.5248    0.0037    0.2831    0.8734    0.5546    0.0045    0.3540    0.8980    0.4514    0.0073;
    0.3197    1.0000    0.5773         0    0.3037    0.9955    0.5613    0.0034    0.2937    0.8939    0.5748    0.0049    0.3488    0.9400    0.4822    0.0079;
%500
  0.2980    1.0000    0.5246    0.0010    0.2557    0.8596    0.6083    0.0048    0.2889    0.9318    0.5235    0.0047    0.3039    0.9848    0.5258         0;
    0.2918    1.0000    0.5121    0.0023    0.2640    0.8671    0.5922    0.0033    0.3068    0.8949    0.5120    0.0047    0.3033    0.9561    0.5345         0;
    0.2895    1.0000    0.5311    0.0010    0.2721    0.8744    0.5988    0.0017    0.2959    0.9188    0.5324    0.0034    0.2970    0.9308    0.5284         0;   
%1000
0.2828    0.8502    0.5570    0.0079    0.2952    0.9614    0.5385    0.0061    0.2868    1.0000    0.6096         0    0.3056    0.9230    0.5620    0.0025;
    0.2917    0.9098    0.5829    0.0044    0.3259    0.9368    0.5319    0.0053    0.3054    1.0000    0.5948         0    0.3107    0.9692    0.6115    0.0025;
    0.2981    0.9401    0.6124    0.0020    0.3182    0.9709    0.5604    0.0033    0.3002    1.0000    0.5921         0    0.3157    0.9943    0.6004    0.0009;
%2000
    0.3612    0.9747    0.6122         0    0.3043    1.0000    0.5696    0.0065    0.2904    0.9273    0.6290    0.0045    0.3651    0.9531    0.4956    0.0083;
    0.3466    0.9530    0.5874         0    0.2976    1.0000    0.5749    0.0056    0.2957    0.9077    0.6352    0.0043    0.3351    0.9733    0.5219    0.0081;
    0.3225    0.9337    0.5637         0    0.2884    1.0000    0.5810    0.0027    0.2850    0.9114    0.6213    0.0021    0.3230    0.9500    0.5322    0.0046;

    %%%%%%%%%%%%%%%%%%%%%%%%%内圈210
%1
0.3904    0.8831    0.7692         0    0.3094    1.0000    0.6301    0.0076    0.2757    0.9399    0.7914    0.0068    0.3128    0.9404    0.5423    0.0141;
 0.3388    0.8698    0.7135    0.0063    0.3129    1.0000    0.6280    0.0003    0.2827    0.9442    0.7784         0    0.3097    0.9342    0.5609    0.0071;
 0.3148    0.8740    0.6922    0.0085    0.3039    1.0000    0.6134    0.0023    0.2814    0.9396    0.7393         0    0.2928    0.9348    0.5758    0.0077;
%2000
 0.3230    0.8975    0.6602    0.0103    0.3281    1.0000    0.6381         0    0.2942    0.9699    0.7800    0.0004    0.3064    0.9850    0.6006    0.0071;
    0.3070    0.8714    0.6499    0.0124    0.3109    1.0000    0.6155    0.0026    0.2876    0.9622    0.7293         0    0.2831    0.9907    0.6094    0.0077;
    0.3028    0.8856    0.6672    0.0096    0.3022    1.0000    0.6302    0.0026    0.2842    0.9744    0.7304         0    0.2802    0.9940    0.6056    0.0083;
%1000
 0.2799    0.9509    0.7659    0.0006    0.2976    0.9678    0.5610    0.0074    0.2978    0.8908    0.6250    0.0070    0.3330    1.0000    0.6170         0;
    0.2866    0.9391    0.7548         0    0.2914    0.9495    0.5738    0.0075    0.2851    0.8889    0.6348    0.0058    0.3135    1.0000    0.6049    0.0012;
];




O =16;
Q =4;

% "true" parameters
K=O;L=4;%L对应的是几种故障？k指矢量化参数.
% maxiter=500;%矢量化参数
   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%可以用下面的程序自动产生训练数据 
% prior0 = normalise(rand(Q,1));
% transmat0 = mk_stochastic(rand(Q,Q));
% obsmat0 = mk_stochastic(rand(Q,O));
% training data
% T = 10;
% nex = 20;
% data = dhmm_sample(prior0, transmat0, obsmat0, T, nex);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 for ii=1:4
     %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%lloyds和量化公式对特征样本进行量化得到离散码本
 for q=20*(ii-1)+1:20*ii
  a=y(q,:);
  [partition,codebook] = lloyds(a,2^4);
  N=length(partition)+1;  
  for i=1: length(a)
     if a(i)>partition(N-1)
         c(i)=N; 
     else if  a(i)<=partition
           c(i)=1;   
         else
            for j=1:N-2 
            if  partition(j)<a(i)&a(i)<=partition(j+1)  
            c(i)=j+1;
            end
            end
        end
     end  
  end
  d(q,:)=c;
 end
% initial guess of parameters初始化概率矩阵
prior1 = normalise(rand(Q,1));
transmat1 = mk_stochastic(rand(Q,Q));
obsmat1 = mk_stochastic(rand(Q,O));

% improve guess of parameters using EM12*(j-1)+1):12*j,:,j用码本进行训练
[LL, prior2(:,:,ii), transmat2(:,:,ii), obsmat2(:,:,ii)] = dhmm_em(d((20*(ii-1)+1:20*ii),:), prior1, transmat1, obsmat1, 'max_iter', 100);
figure(1);
plot(LL);%最大似然估计值，即训练曲线
hold on
end 
   
% use model to compute log likelihood

y1=[%%%%%%%%%%%%%%%%%%wuguzhang
    0.8386    0.2566    0.0108    0.0026    1.0000    0.2496    0.0126         0    0.8591    0.2502    0.0161    0.0016    0.7989    0.2506    0.0124    0.0038;
    0.9782    0.2588    0.0103    0.0003    1.0000    0.2587    0.0137         0    0.8863    0.2562    0.0141    0.0021    0.9328    0.2553    0.0113    0.0012;
    1.0000    0.2693    0.0125         0    0.9990    0.2660    0.0140    0.0021    0.9411    0.2608    0.0140    0.0022    0.9491    0.2657    0.0131    0.0022;
%无501
0.8674    0.2354    0.0153         0    1.0000    0.2232    0.0098   0.0003    0.8728    0.2372    0.0143    0.0014    0.7866    0.2219  0.0152    0.0039;
0.9097    0.2406    0.0120    0.0000    1.0000    0.2342    0.0119   0    0.9243    0.2393    0.0137    0.0014    0.8304    0.2333  0.0140    0.0030;
0.9178    0.2399    0.0130    0.0013    1.0000    0.2390    0.0130 0    0.8821    0.2388    0.0135    0.0041    0.8848    0.2329  0.0145    0.0032;
%无1001
1.0000    0.2391    0.0092         0    0.8974    0.2482    0.0139  0.0003    0.8278    0.2268    0.0157    0.0023    0.9483    0.2339 0.0083    0.0019;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 外圈          
0.1101    1.0000    0.2029    0.0075    0.1159    0.9630    0.2440  0.0024    0.1028    0.9952    0.2166    0.0098    0.1192    0.9842  0.2386         0 ;
    %2001
0.0977    0.8699    0.2115    0.0076    0.1098    0.8924    0.2193  0    0.0973    0.9170    0.1949    0.0054    0.1025    1.0000  0.2314    0.0022;
    0.0967    0.9041    0.2048    0.0075    0.1070    0.8998    0.2185    0    0.1035    0.9206    0.1919    0.0050    0.1081    1.0000    0.2294    0.0015;
    0.1025    0.9874    0.2184    0.0085    0.1135    0.9785    0.2349   0    0.1104    0.9873    0.2062    0.0054    0.1184    1.0000  0.2406    0.0015;
  %800
   0.1401    1.0000    0.2312         0    0.0999    0.9353    0.2255    0.0109    0.1372    0.9847    0.2229    0.0009    0.0925    0.9485    0.2596    0.0125;
    0.1343    1.0000    0.2370         0    0.0990    0.9527    0.2286    0.0118    0.1287    0.9951    0.2255    0.0011    0.0921    0.9627    0.2594    0.0126;
    0.1303    1.0000    0.2342         0    0.0943    0.9511    0.2288    0.0117    0.1268    0.9956    0.2262    0.0006    0.0912    0.9474    0.2419    0.0123;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% %滚动体
   0.9175    0.6558    0.9363    0.0083    0.8840    0.6861    0.8685         0    0.8488    0.6859    1.0000    0.0031    0.8549    0.6656    0.9171    0.0082;
 %800
 0.8654    0.7076    0.8843    0.0043    0.9280    0.6275    1.0000    0.0011    0.8961    0.6818    0.8148         0    0.9436    0.6349    0.9652    0.0019;
    0.7943    0.7377    0.9344    0.0165    0.8500    0.6851    1.0000    0.0058    0.9094    0.6549    0.8666    0.0077    0.8901    0.6806    0.9193         0;
    0.8827    0.6982    0.9819    0.0100    0.8625    0.6930    1.0000    0.0066    0.9270    0.6576    0.9426         0    0.9188    0.6959    0.9493    0.0013;
%2000
0.7712    0.6295    0.7880    0.0214    0.8544    0.6049    0.9009    0.0122    0.7276    0.7111    0.7595    0.0156    0.7843    0.7118    1.0000         0;
    0.8832    0.6550    0.8697    0.0093    0.9083    0.6464    0.9709         0    0.8716    0.6800    0.8261    0.0072    0.8174    0.7143    1.0000    0.0076;
    0.9032    0.6608    0.9340    0.0092    0.8994    0.6933    0.9876    0.0042    0.9316    0.6769    0.8619    0.0042    0.9085    0.7010    1.0000         0;

 %%%%%%%%%%%%%%%%%%%%%%%内全
0.2893    0.9615    0.7282         0    0.2817    0.9643    0.6058    0.0086    0.2873    0.9130    0.6552    0.0049    0.3015    1.0000    0.6252    0.0026;
%500
 0.2846    1.0000    0.6214         0    0.2587    0.9050    0.7433    0.0002    0.2813    0.9016    0.5473    0.0078    0.2943    0.8503    0.5988    0.0055;
    0.2971    1.0000    0.5985         0    0.2685    0.9002    0.7235    0.0005    0.2771    0.8977    0.5650    0.0086    0.2779    0.8637    0.6120    0.0064;
    0.2849    1.0000    0.5678    0.0013    0.2633    0.8849    0.6764         0    0.2604    0.8853    0.5723    0.0085    0.2711    0.8578    0.6034    0.0044;
0.4913    0.6550    1.0000    0.0043    0.5016    0.6786    0.7482    0.0075    0.5061    0.6906    0.8133         0    0.5652    0.6757    0.7148    0.0059;
    0.5224    0.6961    1.0000    0.0023    0.5182    0.7250    0.8182    0.0059    0.5363    0.7200    0.8531         0    0.5726    0.7207    0.7914    0.0052;
    0.5583    0.7463    1.0000    0.0004    0.5582    0.7603    0.8525    0.0045    0.5592    0.7624    0.8938         0    0.5860    0.7703    0.8428    0.0032;

    ];

for ii=1:28
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%对测试样本量化
  a=y1(ii,:);
  [partition,codebook] = lloyds(a,2^4);
  N=length(partition)+1;  
  for i=1: length(a)
     if a(i)>partition(N-1)
         c(i)=N; 
     else if  a(i)<=partition
           c(i)=1;   
         else
            for j=1:N-2 
            if  partition(j)<a(i)&a(i)<=partition(j+1)  
            c(i)=j+1;
            end
            end
        end
     end  
  end
  C1(ii,:)=c;%选用测试数据样本
end
%%%%%%%%%%%%%%%%%%%%%%%故障识别
for j=1:28
   C= C1(j,:);
for ii=1:L
loglik = dhmm_logprob(C, prior2(:,:,ii), transmat2(:,:,ii), obsmat2(:,:,ii));
b(j,ii)=(loglik);
end
end